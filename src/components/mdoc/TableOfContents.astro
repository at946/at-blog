---
import { type CollectionEntry, getEntry } from 'astro:content';
import Link from './Link.astro';

interface ToCItem {
	slug: string;
	text: string;
}

const entry: CollectionEntry = await getEntry('blog', Astro.params.path);
const { headings } = await entry.render();
const tocItems: ToCItem[] = headings
	.filter((heading) => heading.depth < 3)
	.map((heading) => ({ slug: heading.slug, text: heading.text }));
---

<h2>Table of Contents</h2>
<ul>
{ tocItems.map((tocItem) => (
  <li class="my-0">{ <Link href={`#${tocItem.slug}`}>{tocItem.text}</Link> }</li>
))}
</ul>